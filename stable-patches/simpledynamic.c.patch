diff --git a/test/simpledynamic.c b/test/simpledynamic.c
index 2cced8c..3603fc6 100644
--- a/test/simpledynamic.c
+++ b/test/simpledynamic.c
@@ -8,12 +8,14 @@
  */
 
 #include <string.h>
+#include <stdio.h>
 #include <stdlib.h>              /* For NULL */
 #include <openssl/macros.h>      /* For NON_EMPTY_TRANSLATION_UNIT */
 #include <openssl/e_os2.h>
 #include "simpledynamic.h"
 
 #if defined(DSO_DLFCN) || defined(DSO_VMS)
+# include <errno.h>
 
 int sd_load(const char *filename, SD *lib, int type)
 {
@@ -34,7 +36,26 @@ int sd_sym(SD lib, const char *symname, SD_SYM *sym)
 
 int sd_close(SD lib)
 {
-    return dlclose(lib) != 0 ? 0 : 1;
+    int rc;
+
+    errno = 0;
+    rc = dlclose(lib);
+    if (rc != 0) {
+#ifdef __MVS__
+        /*
+         * On z/OS, dlclose() can return -1 with specific errnos that are
+         * acceptable in the context of these tests:
+         * - 103567 (CEE3567I): Logical delete performed, but not physically
+         *   deleted (e.g., other references exist).
+         * - 103565 (CEE3565I): The input dll-token was NULL, which can happen
+         *   during cleanup.
+         */
+        if (errno == 103567 || errno == 103565)
+            return 1;
+#endif
+        return 0;
+    }
+    return 1;
 }
 
 const char *sd_error(void)
